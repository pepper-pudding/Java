# Hash Map

## HashMap

{% embed url="https://docs.oracle.com/javase/8/docs/api/java/util/HashMap.html" %}

HashMap은 Map 인터페이스를 구현한 대표적인 Map Collection입니다.

Map 인터페이스를 상속하고 있기에 Map의 성질을 그대로 가지고 있습니다. Map은 키와 값으로 구성된 Entry 객체를 저장하는 구조를 가지고 있는 자료구조입니다. 여기서 키와 값은 모두 객체입니다. 값은 중복 저장될 수 있지만 키는 중복 저장될 수 없습니다. 만약 기존에 저장된 키와 동일한 키로 값을 저장하면 기존의 값은 없어지고 새로운 값으로 대치됩니다.&#x20;

HashMap은 해싱을 사용하기 때문에 많은 양의 데이터를 검색하는 데 있어서 뛰어난 성능을 보입니다.

## 해시 분포와 해시 충돌

HashMap은 기본적으로 각 객체의 hashCode() 메서드가 반환하는 값을 사용하는데, 결과 자료형은 int입니다. 32비트 정수 자료형으로는 완전한 해시 함수를 만들 수 없습니다.&#x20;

논리적으로 생성 가능한 객체의 수가 2^32보다 많을 수 있기 때문이며, 모든 HashMap 객체에서 O(1)을 보장하기 위해 랜덤 접근이 가능하게 하려면 원소가 2^32인 배열을 모든 HashMap이 가지고 있어야 하기 때문입니다.

따라서 HashMap을 비롯한 많은 해시 함수를 이용하는 associative array 구현체에서는 메모리를 절약하기 위하여 실제 해시 함수의 표현 정수 범위보다, M개의 원소가 있는 배열만을 사용합니다. 따라서 다음과 같이 객체에 대한 해시 코드의 나머지 값을 해시 버킷 인덱스 값으로 사용합니다.

```
int index = X.hashCode() % M;
```

이 코드와 같은 방식을 사용하면, 서로 다른 해시 코드를 가지는 서로 다른 객체가 1/M의 확률로 같은 해시 버킷을 사용하게 됩니다. 이는 해시 함수가 얼마나 해시 충돌을 회피하도록 잘 구현되었느냐에 상관없이 발생할 수 있는 또 다른 종류의 해시 충돌입니다.

이렇게 해시 충돌이 발생하더라도 키-값 쌍 데이터를 잘 저장하고 조회할 수 있게 하는 방식에는 대표적으로 두 가지가 있는데, 하나는 Open Addressing이고, 다른 하나는 Separate Chaining입니다. 이 둘 외에도 해시 충돌을 해결하기 위한 다양한 자료 구조가 있지만, 거의 모두 이 둘을 응용한 것이라고 할 수 있습니다.







## 참고자료

{% embed url="https://d2.naver.com/helloworld/831311" %}







HashMap의 인스턴스에는 성능에 영향을 미치는 두 가지 매개변수가 있다.

1. 초기 용량
2. 로드 비율

용량 은 해시 테이블 의 버킷 수이고 초기 용량은 단순히 해시 테이블이 생성된 시점의 용량입니다. 로드 팩터 는 용량이 자동으로 증가하기 전에 해시 테이블이 얼마나 가득 찰 수 있는지를 측정한 것입니다 . 해시 테이블의 항목 수가 로드 팩터와 현재 용량의 곱을 초과하면 해시 테이블이 버킷 수의 약 2배가 되도록 해시 테이블이 다시 해시됩니다(즉, 내부 데이터 구조가 다시 작성됨).

\
일반적으로 기본 부하 계수(.75)는 시간과 공간 비용 간에 적절한 절충안을 제공합니다. 값이 높을수록 공간 오버헤드는 줄어들지만 조회 비용은 증가합니다( get 및 put 을 포함하여 HashMap 클래스 의 대부분의 작업에 반영됨 ). 재해시 작업의 수를 최소화하기 위해 초기 용량을 설정할 때 맵의 예상 항목 수와 로드 요소를 고려해야 합니다. 초기 용량이 로드 팩터로 나눈 최대 항목 수보다 큰 경우 재해시 작업이 발생하지 않습니다.



HashMap 인스턴스 에 많은 매핑을 저장 해야 하는 경우 충분히 큰 용량으로 생성하면 테이블을 확장하기 위해 필요에 따라 자동 재해싱을 수행하는 것보다 매핑을 더 효율적으로 저장할 수 있습니다. 동일한 키를 여러 개 사용 `hashCode()`하는 것은 모든 해시 테이블의 성능을 저하시키는 확실한 방법입니다. 영향을 개선하기 위해 키가 [`Comparable`](https://docs.oracle.com/javase/8/docs/api/java/lang/Comparable.html)인 경우 이 클래스는 키 간의 비교 순서를 사용하여 관계를 끊을 수 있습니다.
